{"hash":"c2e3c00237a7e5053ebdf887a8a5b65c9e13a460","data":{"post":{"title":"Consume .Net Web service using jQuery","path":"/consume-net-web-service-using-j-query/","date":"29. April 2008","timeToRead":7,"tags":[{"id":".Net","title":".Net","path":"/tag/.Net/"},{"id":"JavaScript","title":"JavaScript","path":"/tag/JavaScript/"}],"description":"The JavaScript functionality that is injected into .Net pages seems limited when compared to jQuery.\nWhilst looking for a way to use jQuery instead of the stock Microsoft client library, I came across an excellent article.","content":"<p>The JavaScript functionality that is injected into .Net pages seems limited when compared to jQuery.</p>\n<p>Whilst looking for a way to use jQuery instead of the stock Microsoft client library, I came across this <a href=\"http://encosia.com/2008/03/27/using-jquery-to-consume-aspnet-json-web-services/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">excellent article</a>.</p>\n<p>There doesn 't seem to be too much on Web about this subject. Maybe most .Net developers stick to Microsoft tools, but I like using jQuery for all my client scripting, and would rather not use more than one library. So as it look me a while to get example code working, I 've included my efforts.</p>\n<p>Below is a simple .Net Web service. Once again, I 've used continents and countries as my simple dataset. Pass a continent to the service, and it will return an array of countries.</p>\n<pre class=\"language-text\"><code class=\"language-text\">&lt;%@ webservice Language=&quot;C#&quot; class=&quot;AndrewRowland.Continents&quot; %&gt;\n\nusing System;\nusing System.Web.Script.Services;\nusing System.Web.Services;\nusing System.Collections;\nusing System.Collections.Specialized;\n\nnamespace AndrewRowland\n{\n    [ScriptService]\n    [WebService(Namespace = &quot;AndrewRowland&quot;)]\n    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]\n    public class Continents\n    {\n        [WebMethod(Description=&quot;Returns array of countries for a given continent.&quot;)]\n        [ScriptMethod(ResponseFormat = ResponseFormat.Json)]\n        public string[] GetCountries(string continent)\n        {\n            Hashtable ht = new Hashtable();\n\n            ht.Add(&quot;Europe&quot;, new string[] {&quot;UK&quot;, &quot;France&quot;, &quot;Germany&quot;});\n            ht.Add(&quot;Africa&quot;, new string[] {&quot;South Africa&quot;, &quot;Zimbabwe&quot;, &quot;Cameroon&quot;});\n            ht.Add(&quot;North America&quot;, new string[] {&quot;USA&quot;, &quot;Canada&quot;});\n\n            return (string[]) ht[continent];\n        }\n    }\n}</code></pre>\n<p>Note the response format, which is JSON. Originally, I omitted this, and serialized the data as a JSON string using the .Net JavaScriptSerializer class, before returning it.</p>\n<p>This resulted in the client having to evaluate the returned string to build an array. By returning an array, the JSON object is instantly available in our client code, without any jiggery-pokery.</p>\n<p>To enable the client to call the Web service, I had to add following in my web.config file under the system.web section:</p>\n<pre class=\"language-text\"><code class=\"language-text\">&lt;webServices&gt;\n    &lt;protocols&gt;\n        &lt;add name=&quot;HttpPost&quot;/&gt;\n    &lt;/protocols&gt;\n&lt;/webServices&gt;</code></pre>\n<p>Sample client code that calls the .Net Web service:</p>\n<pre class=\"language-text\"><code class=\"language-text\">&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;World example&lt;/title&gt;\n    &lt;script type=&quot;text/javascript&quot; src=&quot;/path/to/jquery.js&quot;&gt;&lt;/script&gt;\n    &lt;script type=&quot;text/javascript&quot;&gt;\n    $(document).ready(function() {\n        $(&#39;#submit&#39;).click(function() {\n            $.ajax({\n                type: &quot;POST&quot;,\n                data: &#39;{continent: &quot;&#39; + $(&#39;#txtContinent&#39;).val() + &#39;&quot;}&#39;,\n                url: &quot;/services/example.asmx/GetCountries&quot;,\n                contentType: &quot;application/json; charset=utf-8&quot;,\n                dataType: &quot;json&quot;,\n                success: function(response) {\n                    var data = (typeof response.d) == &#39;string&#39; ? eval(&#39;(&#39; + response.d + &#39;)&#39;) : response.d;\n\n                    $(&#39;#result&#39;).empty().append(&#39;&lt;table border=1&gt;&lt;thead&gt;&lt;tr&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;/tbody&gt;&lt;/table&gt;&#39;);\n\n                    $(&#39;&lt;th/&gt;&#39;).text($(&#39;#txtContinent&#39;).val()).appendTo(&#39;#result thead tr&#39;);\n\n                    for (var i = 0; i &lt; data.length; i ++) {\n                        $(&#39;&lt;tr/&gt;&#39;).append($(&#39;&lt;td/&gt;&#39;).text(data[i])).appendTo(&#39;#result tbody&#39;);\n                    }\n                },\n                failure: function(msg) {\n                    $(&#39;#result&#39;).empty().append(msg);\n                }\n            });\n        });\n    });\n    &lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;p&gt;&lt;label for=&quot;txtContinent&quot;&gt;Continent&lt;/label&gt;&lt;br /&gt;\n&lt;input type=&quot;text&quot; id=&quot;txtContinent&quot; /&gt; &lt;input id=&quot;submit&quot; type=&quot;button&quot; value=&quot;Submit&quot; /&gt;&lt;/p&gt;\n\n&lt;div id=&quot;result&quot;&gt;&lt;/div&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;</code></pre>\n<p>Note line 15:</p>\n<pre class=\"language-text\"><code class=\"language-text\">var data = (typeof response) == &#39;string&#39; ? eval(&#39;(&#39; + response + &#39;)&#39;) : response;</code></pre>\n<p>I added this line so that the data object is correctly evaluated if a serialized JSON string is returned.</p>\n<p>There you have it, avoid the Microsoft code bloat, with not a ScriptManager tag in sight.</p>\n<h2 id=\"25-thoughts-on-consume-net-web-service-using-jquery\"><a href=\"#25-thoughts-on-consume-net-web-service-using-jquery\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>25 thoughts on “Consume .Net Web service using jQuery”</h2>\n<h3 id=\"andy\"><a href=\"#andy\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Andy</h3>\n<p><em>August 12, 2008 at 5:34 pm</em></p>\n<p>If you look at line 10 in the HTML example above, the data key of the AJAX request contains a serialised JSON object. I’ve manually serialised the parameters to be sent to the Web service. If your object is more complex, use a JSON stringifier.</p>\n<p>The example Web service I’ve provided takes this very simple JSON object to obtain the parameter continent. It then returns a list of countries.</p>\n<p>Hope this helps.</p>\n<hr>\n<h3 id=\"andy-1\"><a href=\"#andy-1\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Andy</h3>\n<p><em>August 12, 2008 at 5:34 pm</em></p>\n<p>Indeed, and it appears many people are heading in this direction. Thanks very much for posting the first comment.</p>\n<hr>\n<h3 id=\"govind\"><a href=\"#govind\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Govind</h3>\n<p><em>August 12, 2008 at 5:34 pm</em></p>\n<p>+1. Beautiful, I too love jquery and moved away from the scriptmanager/updatepanel/proxy stuff. It was way too clunky.</p>\n<hr>\n<h3 id=\"zbrong\"><a href=\"#zbrong\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>zbrong</h3>\n<p><em>August 12, 2008 at 5:34 pm</em></p>\n<p>good article, thanks</p>\n<p>would you show us how to post a json object to web service and how the service consume the json object, best is sample</p>\n<p>thanks</p>\n<hr>\n<h3 id=\"david\"><a href=\"#david\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>david</h3>\n<p><em>September 11, 2008 at 7:01 am</em></p>\n<p>Hello,</p>\n<p>I am using .net 2.0 with c# and I am stuggling to get any of these exemples working. Could you please send a .net zipped up proj or solutio please</p>\n<hr>\n<h3 id=\"paul\"><a href=\"#paul\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>paul</h3>\n<p><em>September 15, 2008 at 9:46 am</em></p>\n<p>I’m also using .net 2 with C# and would appreciate the revised solution. Thanks in advance.</p>\n<hr>\n<h3 id=\"andy-2\"><a href=\"#andy-2\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Andy</h3>\n<p><em>September 15, 2008 at 9:46 am</em></p>\n<p>Seems to be a fair amount of interest in this post. As you can see, I’m stuggling to find the time to update this blog more regularly.</p>\n<p>I’ll try to come up with a basic site, and post it here some time this week. I don’t use Visual Studio, so I can’t create a project.</p>\n<p>Thanks gents.</p>\n<hr>\n<h3 id=\"andy-3\"><a href=\"#andy-3\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Andy</h3>\n<p><em>September 26, 2008 at 8:46 pm</em></p>\n<p>Sorry for the delay. I installed Visual Studio 2008 Express, and created this project.</p>\n<p>Hope this helps.</p>\n<hr>\n<h3 id=\"fawad-hassan\"><a href=\"#fawad-hassan\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Fawad Hassan</h3>\n<p><em>March 14, 2009 at 3:27 pm</em></p>\n<p>nice article!</p>\n<p>thanks</p>\n<p>Now I shall try it myself...</p>\n<hr>\n<h3 id=\"yoav\"><a href=\"#yoav\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Yoav</h3>\n<p><em>August 20, 2009 at 4:13 pm</em></p>\n<p>Hi there,</p>\n<p>if you’re interested in creating a more object oriented proxy for a webservice using jQuery check out my article on:</p>\n<p><a href=\"http://yoavniran.wordpress.com/2009/08/02/creating-a-webservice-proxy-with-jquery/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://yoavniran.wordpress.com/2009/08/02/creating-a-webservice-proxy-with-jquery/</a></p>\n<hr>\n<h3 id=\"andy-4\"><a href=\"#andy-4\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Andy</h3>\n<p><em>August 20, 2009 at 4:17 pm</em></p>\n<p>Good stuff Yoav. I’m sure your article will be useful to others as well.</p>\n<hr>\n<h3 id=\"dacoder\"><a href=\"#dacoder\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>DaCoder</h3>\n<p><em>November 2, 2009 at 4:32 pm</em></p>\n<p>HI</p>\n<p>I am trying to use FullCalendar to display events but I am having trouble trying to get the right json array returned.</p>\n<p>Heres my server side code</p>\n<pre class=\"language-text\"><code class=\"language-text\">public string[][] GetEventsForDate(string currentDate)\n{\n    Hashtable ht = new Hashtable();\n\n    string[][] jaggedArray1 =\n    {\n        new string[] {“1″,”Meeting One”,”2009-10-30T08:15:00.000+10:00″,”2009-10-30T10:15:00.000+10:00″},\n        new string[] {“2″,”Meeting Two”,”2009-10-30T12:15:00.000+10:00″,”2009-10-30T13:15:00.000+10:00″},\n        new string[] {“3″,”Meeting Three”,”2009-10-30T02:15:00.000+10:00″,”2009-10-30T03:15:00.000+10:00″}\n    };\n\n    return jaggedArray1;\n}</code></pre>\n<p>Any ideas?</p>\n<hr>\n<h3 id=\"dacoder-1\"><a href=\"#dacoder-1\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>DaCoder</h3>\n<p><em>November 4, 2009 at 4:17 am</em></p>\n<p>Hi</p>\n<p>I was able to figure out a way to integrate the FullCalendar with ASP.Net, heres the link to a write up I did</p>\n<p><a href=\"http://www.101webdesigns.com/index.php/2009/11/03/jquery-calendar-in-asp-net/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://www.101webdesigns.com/index.php/2009/11/03/jquery-calendar-in-asp-net/</a></p>\n<p>Hope someone finds it useful</p>\n<hr>\n<h3 id=\"kenny-evitt\"><a href=\"#kenny-evitt\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Kenny Evitt</h3>\n<p><em>May 14, 2010 at 4:51 am</em></p>\n<p>Excellent example!</p>\n<hr>\n<h3 id=\"prabu\"><a href=\"#prabu\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Prabu</h3>\n<p><em>May 14, 2010 at 4:51 am</em></p>\n<p>Hi.</p>\n<p>I am wondering if this works from a static html page outside of the webservice project?</p>\n<hr>\n<h3 id=\"rupesh\"><a href=\"#rupesh\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Rupesh</h3>\n<p><em>May 14, 2010 at 4:56 am</em></p>\n<p>Hi am using Webservice as a different project and when i add a webreference of this in my project. then jquery call does not works. if the asmx file is in the same webapplication project then it works fine. Is there any way to cosume the webservice’s webmethod by puting the web reference of weservice.</p>\n<hr>\n<h3 id=\"andy-5\"><a href=\"#andy-5\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Andy</h3>\n<p><em>May 14, 2010 at 4:57 am</em></p>\n<p>No reason why not. In your AJAX call, you will have to use the full URL if the service is running on different domain. Other than that consideration, it should not be a problem.</p>\n<hr>\n<h3 id=\"jake\"><a href=\"#jake\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Jake</h3>\n<p><em>July 21, 2010 at 5:41 pm</em></p>\n<p>Here is an example of how to get FullCalendar working in VB.NET using a webservice. <a href=\"http://jake1164.blogspot.com/2010/06/jquery-fullcalendar-and-aspnet.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://jake1164.blogspot.com/2010/06/jquery-fullcalendar-and-aspnet.html</a></p>\n<hr>\n<h3 id=\"michael-mofokeng\"><a href=\"#michael-mofokeng\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Michael Mofokeng</h3>\n<p><em>September 2, 2010 at 8:19 am</em></p>\n<p>Hi There. I’ve re-created the example as a project but its not working from my side. It’is doesn’t return a success or failed message either.</p>\n<hr>\n<h3 id=\"mickey\"><a href=\"#mickey\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Mickey</h3>\n<p><em>January 3, 2011 at 1:00 pm</em></p>\n<p>I have a simple example of how I call a webservice using jquery on my tumblr blog. <a href=\"http://mickeyelliott.tumblr.com/post/1581098755/using-jquery-to-call-a-webservice\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://mickeyelliott.tumblr.com/post/1581098755/using-jquery-to-call-a-webservice</a></p>\n<hr>\n<h3 id=\"bhargav\"><a href=\"#bhargav\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Bhargav</h3>\n<p><em>February 8, 2011 at 10:28 am</em></p>\n<p>Really Grt article, helped me a lot. Thank you very much.</p>\n<hr>\n<h3 id=\"vani\"><a href=\"#vani\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>vani</h3>\n<p><em>April 2, 2011 at 12:03 pm</em></p>\n<p>nice</p>\n<hr>\n<h3 id=\"nidhi\"><a href=\"#nidhi\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Nidhi</h3>\n<p><em>April 19, 2011 at 7:18 pm</em></p>\n<p>Is it possible to retrieve the user’s identity (authentication) in the web method?</p>\n<p>I’m also wondering if user roles can be checked in web methods. If someone has some info or links, please share</p>\n<hr>\n<h3 id=\"rajesh143\"><a href=\"#rajesh143\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Rajesh143</h3>\n<p><em>September 6, 2011 at 1:11 pm</em></p>\n<p>Hi Andy , nice post it helped me.</p>\n<p>I created a static HTML page and dumped the html code above in that and my web service works fine, But im facing a problem in the response part i.e in the success\nmethod the response is <code class=\"language-text\">NULL</code>.</p>\n<p>Can you please address my problem ASAP.</p>\n<hr>\n<h3 id=\"ad-guru\"><a href=\"#ad-guru\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>ad guru</h3>\n<p><em>March 13, 2012 at 12:43 am</em></p>\n<p>Great help. Thank you.</p>\n<hr>\n","cover_image":null}},"context":{}}