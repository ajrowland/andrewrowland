<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>.Net - Andrew Rowland</title><meta name="gridsome:hash" content="b440d2dfedc5f7355f69b42f14a3a17b5add6387"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.12"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="description" name="description" content="I only want to help you"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.9bb7ffafafc09ac851d81afb65b8ef59.png"><link rel="preload" href="/assets/css/0.styles.11ed0a24.css" as="style"><link rel="preload" href="/assets/js/app.261c0a70.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--tag-vue.e41997c1.js" as="script"><link rel="prefetch" href="/assets/js/page--src--pages--404-vue.3dc0d434.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.279a9bb8.js"><link rel="prefetch" href="/assets/js/page--src--templates--post-vue.8ad119a0.js"><link rel="prefetch" href="/assets/js/page--src--templates--redirect-vue.91df8a62.js"><link rel="stylesheet" href="/assets/css/0.styles.11ed0a24.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <script>
      // Add dark / light detection that runs before Vue.js load. Borrowed from overreacted.io
      (function() {
        window.__onThemeChange = function() {};
        function setTheme(newTheme) {
          window.__theme = newTheme;
          preferredTheme = newTheme;
          document.body.setAttribute('data-theme', newTheme);
          window.__onThemeChange(newTheme);
        }

        var preferredTheme;
        try {
          preferredTheme = localStorage.getItem('theme');
        } catch (err) { }

        window.__setPreferredTheme = function(newTheme) {
          setTheme(newTheme);
          try {
            localStorage.setItem('theme', newTheme);
          } catch (err) {}
        }

        var darkQuery = window.matchMedia('(prefers-color-scheme: dark)');
        darkQuery.addListener(function(e) {
          window.__setPreferredTheme(e.matches ? 'dark' : 'light')
        });

        setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'));
      })();
    </script>

    <div id="app" data-server-rendered="true"><header class="header"><div class="header__left"><a href="/" class="logo active"><span class="logo__text">
    ← Andrew Rowland
  </span></a></div><div class="header__right"><button role="button" aria-label="Toggle dark/light" class="toggle-theme"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></button></div></header><main class="main"><h1 class="tag-title text-center space-bottom">
    # .Net
  </h1><div class="posts"><div class="post-card content-box"><div class="post-card__header"><!----></div><div class="post-card__content"><h2 class="post-card__title">Entity Framework quick start</h2><p class="post-card__description">Microsoft’s Entity Framework has been around a while, but with it’s latest incarnation it is really shaping up nicely. I’ve been enjoying the ‘code first’ approach in version 4.1 of the framework. This allows you start your application design from POCOs, allowing the framework to infer the database design for you.</p><div class="post-meta post-card__meta">
   Posted 13. September 2011.
   <strong>3 min read.</strong></div><div class="post-tags post-card__tags"></div><a href="/entity-framework-quick-start/" class="post-card__link">Link</a></div></div><div class="post-card content-box"><div class="post-card__header"><!----></div><div class="post-card__content"><h2 class="post-card__title">W3C validation of ASP.Net output</h2><p class="post-card__description">A while ago I had to make certain that a CMS driven site built in .Net met some validation criteria. Specifically the XHTML markup. Running it by the W3C validator service, the markup always failed.</p><div class="post-meta post-card__meta">
   Posted 25. July 2009.
   <strong>1 min read.</strong></div><div class="post-tags post-card__tags"></div><a href="/w3-c-validation-of-asp-net-output/" class="post-card__link">Link</a></div></div><div class="post-card content-box"><div class="post-card__header"><!----></div><div class="post-card__content"><h2 class="post-card__title">Validation groups in .Net</h2><p class="post-card__description">Evening all. Not posted in a while as I've plenty going on in the 'real' world. Anyway, last week I was building a search form whereby you could either search by reference code, or by using full search criteria.</p><div class="post-meta post-card__meta">
   Posted 24. August 2008.
   <strong>1 min read.</strong></div><div class="post-tags post-card__tags"></div><a href="/validation-groups-in-net/" class="post-card__link">Link</a></div></div><div class="post-card content-box"><div class="post-card__header"><!----></div><div class="post-card__content"><h2 class="post-card__title">jQuery UI Date Picker control issue with .Net</h2><p class="post-card__description">Aye, I do whitter on about jQuery. It's ace. The newly released jQuery UI is pretty special too. One of the many great widgets is the Date Picker control.</p><div class="post-meta post-card__meta">
   Posted 11. June 2008.
   <strong>1 min read.</strong></div><div class="post-tags post-card__tags"></div><a href="/j-query-ui-date-picker-control-issue-with-net/" class="post-card__link">Link</a></div></div><div class="post-card content-box"><div class="post-card__header"><!----></div><div class="post-card__content"><h2 class="post-card__title">Using jQuery selectors to reference .Net controls</h2><p class="post-card__description"></p><div class="post-meta post-card__meta">
   Posted 4. June 2008.
   <strong>1 min read.</strong></div><div class="post-tags post-card__tags"></div><a href="/using-j-query-selectors-to-reference-net-controls/" class="post-card__link">Link</a></div></div><div class="post-card content-box"><div class="post-card__header"><!----></div><div class="post-card__content"><h2 class="post-card__title">Consume .Net Web service using jQuery</h2><p class="post-card__description">The JavaScript functionality that is injected into .Net pages seems limited when compared to jQuery.
Whilst looking for a way to use jQuery instead of the stock Microsoft client library, I came across an excellent article.</p><div class="post-meta post-card__meta">
   Posted 29. April 2008.
   <strong>3 min read.</strong></div><div class="post-tags post-card__tags"></div><a href="/consume-net-web-service-using-j-query/" class="post-card__link">Link</a></div></div></div></main><footer class="footer"><span class="footer__copyright">Copyright © 2019. </span><span class="footer__links"></span></footer></div>
    <script>window.__INITIAL_STATE__={"data":{"tag":{"title":".Net","belongsTo":{"edges":[{"node":{"title":"Entity Framework quick start","path":"\u002Fentity-framework-quick-start\u002F","date":"13. September 2011","timeToRead":3,"description":"Microsoft’s Entity Framework has been around a while, but with it’s latest incarnation it is really shaping up nicely. I’ve been enjoying the ‘code first’ approach in version 4.1 of the framework. This allows you start your application design from POCOs, allowing the framework to infer the database design for you.","content":"\u003Cp\u003EMicrosoft’s Entity Framework has been around a while, but with it’s latest incarnation it is really shaping up nicely. I’ve been enjoying the ‘code first’ approach in version 4.1 of the framework. This allows you start your application design from POCOs, allowing the framework to infer the database design for you. For example, take the following Member entity model:\u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003Eclass Member\n{\n    public int Id { get; set; }\n    public string FirstName { get; set; }\n    public string LastName { get; set; }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EThe following class derives from the DbContext base class, and exposes our Member model:\u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003Eclass EFDbContext : DbContext\n{\n    public DbSet&lt;Member&gt; Members { get; set; }\n\n    public EFDbContext()\n    {\n        Database.SetInitializer&lt;EFDbContext&gt;(new DbContextInitializer());\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ENote the \u003Cstrong\u003ESetInitializer\u003C\u002Fstrong\u003E call in the constructor. This allows us to seed the database with some data, using the following class:\u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003Eclass DbContextInitializer : DropCreateDatabaseIfModelChanges&lt;EFDbContext&gt;\n{\n    protected override void Seed(EFDbContext Context)\n    {\n        new List&lt;Member&gt;\n        {\n            new Member {\n                FirstName = &quot;Andrew&quot;,\n                LastName = &quot;Rowland&quot;\n            },\n            new Member {\n                FirstName = &quot;Roland&quot;,\n                LastName = &quot;Browning&quot;\n            },\n        }.ForEach(m =&gt; Context.Members.Add(m));\n        \n        base.Seed(Context);\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ENow we need a simple repository class, so we can query the database:\u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003Eclass MemberRepository\n{\n    private EFDbContext Context = new EFDbContext();\n\n    public IQueryable&lt;Member&gt; Members\n    {\n        get { return Context.Members; }\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EStandard practice is to use an interface, and obtain this concrete class using an IOC container, but it will do for demonstration purposes.\u003C\u002Fp\u003E\n\u003Cp\u003EDue to lazy loading, nothing would happen until we actually run a query. So finally, a console application to instantiate the repository, and display the data:\u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003Eclass ConsoleApplication\n{\n    static void Main(string[] args)\n    {\n        MemberRepository Repository = new MemberRepository();\n\n        Repository.Members.ToList().ForEach(m =&gt; Console.WriteLine(String.Format(&quot;Member: {0} {1}&quot;, m.FirstName, m.LastName)));\n\n        Console.ReadKey();\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EWe can place all of the code into one console application. Install EF4.1, create a console application in Visual Studio 2010, paste in the class below. You may have to set the startup object in the project properties.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003Eusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Data.Entity;\n\nnamespace EFExample\n{\n    class Member\n    {\n        public int Id { get; set; }\n        public string FirstName { get; set; }\n        public string LastName { get; set; }\n    }\n\n    class EFDbContext : DbContext\n    {\n        public DbSet&lt;Member&gt; Members { get; set; }\n\n        public EFDbContext()\n        {\n            Database.SetInitializer&lt;EFDbContext&gt;(new DbContextInitializer());\n        }\n    }\n\n    class DbContextInitializer : DropCreateDatabaseIfModelChanges&lt;EFDbContext&gt;\n    {\n        protected override void Seed(EFDbContext Context)\n        {\n            new List&lt;Member&gt;\n            {\n                new Member {\n                    FirstName = &quot;Andrew&quot;,\n                    LastName = &quot;Rowland&quot;\n                },\n                new Member {\n                    FirstName = &quot;Roland&quot;,\n                    LastName = &quot;Browning&quot;\n                },\n            }.ForEach(m =&gt; Context.Members.Add(m));\n            \n            base.Seed(Context);\n        }\n    }\n\n    class MemberRepository\n    {\n        private EFDbContext Context = new EFDbContext();\n\n        public IQueryable&lt;Member&gt; Members\n        {\n            get { return Context.Members; }\n        }\n    }\n\n    class ConsoleApplication\n    {\n        static void Main(string[] args)\n        {\n            MemberRepository Repository = new MemberRepository();\n\n            Repository.Members.ToList().ForEach(m =&gt; Console.WriteLine(String.Format(&quot;Member: {0} {1}&quot;, m.FirstName, m.LastName)));\n\n            Console.ReadKey();\n        }\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ERun the application, and the magic begins. If you have an instance of SQL Server Express running, a database with a single Members table will be created, populated with data, and the results displayed.\u003C\u002Fp\u003E\n\u003Cp\u003EBit of a quick post this one, so feel free to ask a question. I’m not certain I’ve added enough detail.\u003C\u002Fp\u003E\n"}},{"node":{"title":"W3C validation of ASP.Net output","path":"\u002Fw3-c-validation-of-asp-net-output\u002F","date":"25. July 2009","timeToRead":1,"description":"A while ago I had to make certain that a CMS driven site built in .Net met some validation criteria. Specifically the XHTML markup. Running it by the W3C validator service, the markup always failed.","content":"\u003Cp\u003EA while ago I had to make certain that a CMS driven site built in .Net met some validation criteria. Specifically the XHTML markup. Running it by the \u003Ca href=\"https:\u002F\u002Fvalidator.w3.org\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EW3C validator service\u003C\u002Fa\u003E, the markup always failed.\u003C\u002Fp\u003E\n\u003Cp\u003EI fixed the obvious within the \u003Cstrong\u003Eweb.config\u003C\u002Fstrong\u003E. For example, the following is needed to force the application to render XHTML:\u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E&lt;configuration&gt;\n    ...\n    &lt;system.web&gt;\n        ...\n        &lt;xhtmlConformance mode=&quot;Strict&quot; \u002F&gt;\n        ...\n    &lt;\u002Fsystem.web&gt;\n    ...\n&lt;\u002Fconfiguration&gt;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EIf I painfully cut and pasted the HTML into the Validatorâ€™s form field, it passed. The problem is, is that the service is not recognised by the Web server, and so a helper file in the application is required.\u003C\u002Fp\u003E\n\u003Cp\u003EIn your web root, create a App_Browsers directory. Within this directory create a file called w3c.browser. Paste the following contents into the file:\u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E&lt;browsers&gt;\n    &lt;browser id=&quot;W3C_Validator&quot; parentID=&quot;default&quot;&gt;\n        &lt;identification&gt;\n            &lt;userAgent match=&quot;^W3C_Validator&quot; \u002F&gt;\n        &lt;\u002Fidentification&gt;\n        &lt;capabilities&gt;\n            &lt;capability name=&quot;browser&quot; value=&quot;W3C Validator&quot; \u002F&gt;\n            &lt;capability name=&quot;ecmaScriptVersion&quot; value=&quot;1.2&quot; \u002F&gt;\n            &lt;capability name=&quot;javascript&quot; value=&quot;true&quot; \u002F&gt;\n            &lt;capability name=&quot;supportsCss&quot; value=&quot;true&quot; \u002F&gt;\n            &lt;capability name=&quot;tables&quot; value=&quot;true&quot; \u002F&gt;\n            &lt;capability name=&quot;tagWriter&quot; value=&quot;System.Web.UI.HtmlTextWriter&quot; \u002F&gt;\n            &lt;capability name=&quot;w3cdomversion&quot; value=&quot;1.0&quot; \u002F&gt;\n        &lt;\u002Fcapabilities&gt;\n    &lt;\u002Fbrowser&gt;\n&lt;\u002Fbrowsers&gt;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EYou should now be able to pass the page by URL:\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca href=\"http:\u002F\u002Fvalidator.w3.org\u002Fcheck?uri=http%3A%2F%2Fwww.andrewrowland.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttp:\u002F\u002Fvalidator.w3.org\u002Fcheck?uri=http%3A%2F%2Fwww.andrewrowland.com\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n"}},{"node":{"title":"Validation groups in .Net","path":"\u002Fvalidation-groups-in-net\u002F","date":"24. August 2008","timeToRead":1,"description":"Evening all. Not posted in a while as I've plenty going on in the 'real' world. Anyway, last week I was building a search form whereby you could either search by reference code, or by using full search criteria.","content":"\u003Cp\u003EEvening all. Not posted in a while as I've plenty going on in the 'real' world. Anyway, last week I was building a search form whereby you could either search by reference code, or by using full search criteria.\u003C\u002Fp\u003E\n\u003Cp\u003EThe problem I had is that both search 'forms' existed on one Web Form, and I was using Validation controls to check each. So when using either submit button, both search groups were validated together. Not useful when I wanted to submit each set of controls independently of each other. So there I was, coding to disable either set of validation controls when a submit button is clicked.\u003C\u002Fp\u003E\n\u003Cp\u003EValidation groups I hear you cry. Yes, I know that now.\u003C\u002Fp\u003E\n\u003Cp\u003EAdd the ValidationGroup attribute to all controls, so you can group them together, and submit them separately from other groups. Example:\u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E&lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;\n\n&lt;p&gt;\n    &lt;asp:TextBox Id=&quot;TextBox1&quot; Runat=&quot;server&quot; ValidationGroup=&quot;First&quot; \u002F&gt;\n    &lt;asp:TextBox Id=&quot;TextBox2&quot; Runat=&quot;server&quot; ValidationGroup=&quot;First&quot; \u002F&gt;\n    &lt;asp:RequiredFieldValidator Id=&quot;RequiredFieldValidator1&quot; Runat=&quot;server&quot; ValidationGroup=&quot;First&quot; ErrorMessage=&quot;TextBox1 should not be blank&quot; ControlToValidate=&quot;TextBox1&quot; \u002F&gt;\n\n    &lt;asp:Button ID=&quot;Submit1&quot; Runat=&quot;server&quot; ValidationGroup=&quot;First&quot; Text=&quot;Submit 1&quot; \u002F&gt;\n&lt;\u002Fp&gt;\n\n&lt;p&gt;\n    &lt;asp:TextBox Id=&quot;TextBox3&quot; Runat=&quot;server&quot; ValidationGroup=&quot;Second&quot; \u002F&gt;\n    &lt;asp:TextBox Id=&quot;TextBox4&quot; Runat=&quot;server&quot; ValidationGroup=&quot;Second&quot; \u002F&gt;\n    &lt;asp:RequiredFieldValidator Id=&quot;RequiredFieldValidator2&quot; Runat=&quot;server&quot; ErrorMessage=&quot; TextBox3 should not be blank&quot; ControlToValidate=&quot;TextBox3&quot; ValidationGroup=&quot;Second&quot; \u002F&gt;\n\n    &lt;asp:Button Id=&quot;Submit2&quot; Runat=&quot;server&quot; ValidationGroup=&quot;Second&quot; Text=&quot;Submit 2&quot; \u002F&gt;\n&lt;\u002Fp&gt;\n\n&lt;\u002Fform&gt;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EAye, easy when you know. Googling is a wonderful thing.\u003C\u002Fp\u003E\n"}},{"node":{"title":"jQuery UI Date Picker control issue with .Net","path":"\u002Fj-query-ui-date-picker-control-issue-with-net\u002F","date":"11. June 2008","timeToRead":1,"description":"Aye, I do whitter on about jQuery. It's ace. The newly released jQuery UI is pretty special too. One of the many great widgets is the Date Picker control.","content":"\u003Cp\u003EAye, I do whitter on about \u003Ca href=\"https:\u002F\u002Fjquery.com\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EjQuery\u003C\u002Fa\u003E. It's ace. The newly released \u003Ca href=\"https:\u002F\u002Fjqueryui.com\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EjQuery UI\u003C\u002Fa\u003E is pretty special too. One of the many great widgets is the Date Picker control.\u003C\u002Fp\u003E\n\u003Cp\u003EI build many .net applications that require date entry, so I implement the Date Picker control often. Unfortunately, there is a problem when it is used on a field that is validated using a .Net validation control. Upon clicking on a date, I get the following error:\u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003Elength is null or not an object\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EThis only occurs when using Internet Explorer. Currently, my only solution is to edit the source code. Locate the following code in \u003Cstrong\u003Ejquery-ui.js\u003C\u002Fstrong\u003E or \u003Cstrong\u003Eui.datepicker.js\u003C\u002Fstrong\u003E:\u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003Einst.input.trigger(&#39;change&#39;)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EReplace it with:\u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003Eif (!$.browser.msie){inst.input.trigger(&#39;change&#39;)}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EThis prevents the change event firing in IE.\u003C\u002Fp\u003E\n\u003Cp\u003EI wouldn't normally advocate changing source code in this manner, as it makes future upgrades tedious. Hopefully it will be addressed in a future release.\u003C\u002Fp\u003E\n"}},{"node":{"title":"Using jQuery selectors to reference .Net controls","path":"\u002Fusing-j-query-selectors-to-reference-net-controls\u002F","date":"4. June 2008","timeToRead":1,"description":"","content":"\u003Cp\u003EYou place a control onto your page:\u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E&lt;asp:Content ID=&quot;Content1&quot; ContentPlaceHolderID=&quot;Content&quot; Runat=&quot;Server&quot;&gt;\n    &lt;asp:TextBox Id=&quot;Firstname&quot; Runat=&quot;Server&quot; \u002F&gt;\n&lt;\u002Fasp:Content&gt;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EThe output is rendered as:\u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E&lt;input name=&quot;ctl00$Content$FirstName&quot; type=&quot;text&quot; id=&quot;ctl00_Content_FirstName&quot; \u002F&gt;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EIn the example above, the disparity in the rendered id attribute occurs because the TextBox control has been placed within a Content control, as the Page object inherits a MasterPage.\u003C\u002Fp\u003E\n\u003Cp\u003ESo how can you robustly reference the control using client-side JavaScript, regardless where the control resides?Â  Using jQuery it's fairly trivial:\u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003Evar $firstname = $(&quot;[id$=FirstName]&quot;);\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EThis little snippet makes use of the jQuery attributeEndsWith selector, as documented \u003Ca href=\"https:\u002F\u002Fjquery.com\u002F#attributevalue\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehere\u003C\u002Fa\u003E.Â  Bare in mind that an array is returned, as any control with an id that ends in FirstName will be selected.\u003C\u002Fp\u003E\n"}},{"node":{"title":"Consume .Net Web service using jQuery","path":"\u002Fconsume-net-web-service-using-j-query\u002F","date":"29. April 2008","timeToRead":3,"description":"The JavaScript functionality that is injected into .Net pages seems limited when compared to jQuery.\nWhilst looking for a way to use jQuery instead of the stock Microsoft client library, I came across an excellent article.","content":"\u003Cp\u003EThe JavaScript functionality that is injected into .Net pages seems limited when compared to jQuery.\u003C\u002Fp\u003E\n\u003Cp\u003EWhilst looking for a way to use jQuery instead of the stock Microsoft client library, I came across this \u003Ca href=\"http:\u002F\u002Fencosia.com\u002F2008\u002F03\u002F27\u002Fusing-jquery-to-consume-aspnet-json-web-services\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Eexcellent article\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003EThere doesn 't seem to be too much on Web about this subject. Maybe most .Net developers stick to Microsoft tools, but I like using jQuery for all my client scripting, and would rather not use more than one library. So as it look me a while to get example code working, I 've included my efforts.\u003C\u002Fp\u003E\n\u003Cp\u003EBelow is a simple .Net Web service. Once again, I 've used continents and countries as my simple dataset. Pass a continent to the service, and it will return an array of countries.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E&lt;%@ webservice Language=&quot;C#&quot; class=&quot;AndrewRowland.Continents&quot; %&gt;\n\nusing System;\nusing System.Web.Script.Services;\nusing System.Web.Services;\nusing System.Collections;\nusing System.Collections.Specialized;\n\nnamespace AndrewRowland\n{\n    [ScriptService]\n    [WebService(Namespace = &quot;AndrewRowland&quot;)]\n    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]\n    public class Continents\n    {\n        [WebMethod(Description=&quot;Returns array of countries for a given continent.&quot;)]\n        [ScriptMethod(ResponseFormat = ResponseFormat.Json)]\n        public string[] GetCountries(string continent)\n        {\n            Hashtable ht = new Hashtable();\n\n            ht.Add(&quot;Europe&quot;, new string[] {&quot;UK&quot;, &quot;France&quot;, &quot;Germany&quot;});\n            ht.Add(&quot;Africa&quot;, new string[] {&quot;South Africa&quot;, &quot;Zimbabwe&quot;, &quot;Cameroon&quot;});\n            ht.Add(&quot;North America&quot;, new string[] {&quot;USA&quot;, &quot;Canada&quot;});\n\n            return (string[]) ht[continent];\n        }\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ENote the response format, which is JSON. Originally, I omitted this, and serialized the data as a JSON string using the .Net JavaScriptSerializer class, before returning it.\u003C\u002Fp\u003E\n\u003Cp\u003EThis resulted in the client having to evaluate the returned string to build an array. By returning an array, the JSON object is instantly available in our client code, without any jiggery-pokery.\u003C\u002Fp\u003E\n\u003Cp\u003ETo enable the client to call the Web service, I had to add following in my web.config file under the system.web section:\u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E&lt;webServices&gt;\n    &lt;protocols&gt;\n        &lt;add name=&quot;HttpPost&quot;\u002F&gt;\n    &lt;\u002Fprotocols&gt;\n&lt;\u002FwebServices&gt;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ESample client code that calls the .Net Web service:\u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;World example&lt;\u002Ftitle&gt;\n    &lt;script type=&quot;text\u002Fjavascript&quot; src=&quot;\u002Fpath\u002Fto\u002Fjquery.js&quot;&gt;&lt;\u002Fscript&gt;\n    &lt;script type=&quot;text\u002Fjavascript&quot;&gt;\n    $(document).ready(function() {\n        $(&#39;#submit&#39;).click(function() {\n            $.ajax({\n                type: &quot;POST&quot;,\n                data: &#39;{continent: &quot;&#39; + $(&#39;#txtContinent&#39;).val() + &#39;&quot;}&#39;,\n                url: &quot;\u002Fservices\u002Fexample.asmx\u002FGetCountries&quot;,\n                contentType: &quot;application\u002Fjson; charset=utf-8&quot;,\n                dataType: &quot;json&quot;,\n                success: function(response) {\n                    var data = (typeof response.d) == &#39;string&#39; ? eval(&#39;(&#39; + response.d + &#39;)&#39;) : response.d;\n\n                    $(&#39;#result&#39;).empty().append(&#39;&lt;table border=1&gt;&lt;thead&gt;&lt;tr&gt;&lt;\u002Ftr&gt;&lt;\u002Fthead&gt;&lt;tbody&gt;&lt;\u002Ftbody&gt;&lt;\u002Ftable&gt;&#39;);\n\n                    $(&#39;&lt;th\u002F&gt;&#39;).text($(&#39;#txtContinent&#39;).val()).appendTo(&#39;#result thead tr&#39;);\n\n                    for (var i = 0; i &lt; data.length; i ++) {\n                        $(&#39;&lt;tr\u002F&gt;&#39;).append($(&#39;&lt;td\u002F&gt;&#39;).text(data[i])).appendTo(&#39;#result tbody&#39;);\n                    }\n                },\n                failure: function(msg) {\n                    $(&#39;#result&#39;).empty().append(msg);\n                }\n            });\n        });\t\n    });\n    &lt;\u002Fscript&gt;\n&lt;\u002Fhead&gt;\n&lt;body&gt;\n\n&lt;p&gt;&lt;label for=&quot;txtContinent&quot;&gt;Continent&lt;\u002Flabel&gt;&lt;br \u002F&gt;\n&lt;input type=&quot;text&quot; id=&quot;txtContinent&quot; \u002F&gt; &lt;input id=&quot;submit&quot; type=&quot;button&quot; value=&quot;Submit&quot; \u002F&gt;&lt;\u002Fp&gt;\n\n&lt;div id=&quot;result&quot;&gt;&lt;\u002Fdiv&gt;\n\n&lt;\u002Fbody&gt;\n&lt;\u002Fhtml&gt;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ENote line 15:\u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003Evar data = (typeof response) == &#39;string&#39; ? eval(&#39;(&#39; + response + &#39;)&#39;) : response;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EI added this line so that the data object is correctly evaluated if a serialized JSON string is returned.\u003C\u002Fp\u003E\n\u003Cp\u003EThere you have it, avoid the Microsoft code bloat, with not a ScriptManager tag in sight.\u003C\u002Fp\u003E\n"}}]}}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.261c0a70.js" defer></script><script src="/assets/js/page--src--templates--tag-vue.e41997c1.js" defer></script>
  </body>
</html>